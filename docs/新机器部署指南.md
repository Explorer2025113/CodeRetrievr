# CodeRetrievr æ–°æœºå™¨éƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨åœ¨æ–°æœºå™¨ä¸Šå®Œæ•´éƒ¨ç½² CodeRetrievr é¡¹ç›®ã€‚

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
2. [ç¬¬ä¸€æ­¥ï¼šå®‰è£…åŸºç¡€è½¯ä»¶](#ç¬¬ä¸€æ­¥å®‰è£…åŸºç¡€è½¯ä»¶)
3. [ç¬¬äºŒæ­¥ï¼šè·å–é¡¹ç›®ä»£ç ](#ç¬¬äºŒæ­¥è·å–é¡¹ç›®ä»£ç )
4. [ç¬¬ä¸‰æ­¥ï¼šé…ç½®Pythonç¯å¢ƒ](#ç¬¬ä¸‰æ­¥é…ç½®pythonç¯å¢ƒ)
5. [ç¬¬å››æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡](#ç¬¬å››æ­¥é…ç½®ç¯å¢ƒå˜é‡)
6. [ç¬¬äº”æ­¥ï¼šå¯åŠ¨æ•°æ®åº“æœåŠ¡](#ç¬¬äº”æ­¥å¯åŠ¨æ•°æ®åº“æœåŠ¡)
7. [ç¬¬å…­æ­¥ï¼šéªŒè¯ç¯å¢ƒ](#ç¬¬å…­æ­¥éªŒè¯ç¯å¢ƒ)
8. [ç¬¬ä¸ƒæ­¥ï¼šè¿è¡Œé¡¹ç›®](#ç¬¬ä¸ƒæ­¥è¿è¡Œé¡¹ç›®)
9. [å¸¸è§é—®é¢˜æ’æŸ¥](#å¸¸è§é—®é¢˜æ’æŸ¥)

---

## ç³»ç»Ÿè¦æ±‚

### ç¡¬ä»¶è¦æ±‚
- **CPU**: 4æ ¸å¿ƒä»¥ä¸Šï¼ˆæ¨è8æ ¸å¿ƒï¼‰
- **å†…å­˜**: 8GBä»¥ä¸Šï¼ˆæ¨è16GBï¼‰
- **ç£ç›˜**: è‡³å°‘20GBå¯ç”¨ç©ºé—´
- **GPU**: å¯é€‰ï¼ˆç”¨äºåŠ é€Ÿæ¨¡å‹æ¨ç†ï¼‰

### è½¯ä»¶è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Windows 10/11, macOS 10.15+, æˆ– Linux (Ubuntu 20.04+)
- **Python**: 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Docker Desktop**: 4.0+ (Windows/macOS) æˆ– Docker Engine 20.10+ (Linux)
- **Docker Compose**: 2.0+
- **Git**: 2.30+

---

## ç¬¬ä¸€æ­¥ï¼šå®‰è£…åŸºç¡€è½¯ä»¶

### 1.1 å®‰è£… Python

**Windows:**
1. è®¿é—® [Pythonå®˜ç½‘](https://www.python.org/downloads/)
2. ä¸‹è½½ Python 3.9+ ç‰ˆæœ¬
3. å®‰è£…æ—¶**å‹¾é€‰** "Add Python to PATH"
4. éªŒè¯å®‰è£…ï¼š
   ```bash
   python --version
   ```

**macOS:**
```bash
# ä½¿ç”¨ Homebrew
brew install python@3.9

# æˆ–ä»å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…
```

**Linux (Ubuntu):**
```bash
sudo apt update
sudo apt install python3.9 python3.9-venv python3-pip
```

### 1.2 å®‰è£… Docker Desktop

**Windows/macOS:**
1. è®¿é—® [Docker Desktopå®˜ç½‘](https://www.docker.com/products/docker-desktop)
2. ä¸‹è½½å¹¶å®‰è£… Docker Desktop
3. å¯åŠ¨ Docker Desktop
4. éªŒè¯å®‰è£…ï¼š
   ```bash
   docker --version
   docker-compose --version
   ```

**Linux:**
```bash
# å®‰è£… Docker Engine
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# å®‰è£… Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose

# éªŒè¯å®‰è£…
docker --version
docker-compose --version
```

### 1.3 å®‰è£… Git

**Windows:**
- è®¿é—® [Gitå®˜ç½‘](https://git-scm.com/download/win) ä¸‹è½½å®‰è£…

**macOS:**
```bash
brew install git
```

**Linux:**
```bash
sudo apt install git
```

### 1.4 å®‰è£… Anacondaï¼ˆå¼ºçƒˆæ¨èï¼‰

**æœ¬é¡¹ç›®å¼ºçƒˆæ¨èä½¿ç”¨ Anaconda**ï¼Œå› ä¸ºå®ƒå¯ä»¥æ›´æ–¹ä¾¿åœ°ç®¡ç† Python ç¯å¢ƒï¼Œç‰¹åˆ«æ˜¯ç§‘å­¦è®¡ç®—åŒ…ï¼ˆå¦‚ PyTorchï¼‰ã€‚

1. è®¿é—® [Anacondaå®˜ç½‘](https://www.anaconda.com/download)
2. ä¸‹è½½å¹¶å®‰è£… Anacondaï¼ˆæˆ– Minicondaï¼Œæ›´è½»é‡ï¼‰
3. **é‡è¦æç¤º**ï¼š
   - **å¦‚æœå¯ä»¥**ï¼šå®‰è£…æ—¶å‹¾é€‰ "Add Anaconda to PATH"ï¼ˆWindowsï¼‰
   - **å¦‚æœæ— æ³•æ·»åŠ åˆ° PATH**ï¼š**ä¸ç”¨æ‹…å¿ƒ**ï¼è¯·ä½¿ç”¨ **Anaconda Prompt**ï¼ˆè§ä¸‹æ–¹è¯´æ˜ï¼‰
4. éªŒè¯å®‰è£…ï¼š
   ```bash
   # å¦‚æœ conda åœ¨ PATH ä¸­
   conda --version
   
   # å¦‚æœ conda ä¸åœ¨ PATH ä¸­ï¼Œä½¿ç”¨ Anaconda Promptï¼ˆWindowsï¼‰
   # æˆ–æŸ¥çœ‹ä¸‹æ–¹çš„è§£å†³æ–¹æ¡ˆ
   ```

**Windows ç”¨æˆ·æ³¨æ„**ï¼š
- âœ… **æ¨è**ï¼šä½¿ç”¨ **Anaconda Prompt** æˆ– **Anaconda PowerShell Prompt**ï¼ˆä»å¼€å§‹èœå•æ‰“å¼€ï¼‰
- âœ… è¿™æ˜¯æœ€ç®€å•å¯é çš„æ–¹æ³•ï¼Œå³ä½¿ conda ä¸åœ¨ PATH ä¸­ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ
- âš ï¸ å¦‚æœ conda ä¸åœ¨ PATH ä¸­ï¼Œåœ¨æ™®é€š PowerShell ä¸­è¿è¡Œ `conda init powershell` å¯èƒ½ä¸èµ·ä½œç”¨

> ğŸ“– **å¦‚æœ conda ä¸åœ¨ PATH ä¸­**ï¼šè¯·æŸ¥çœ‹ [Condaä¸åœ¨PATHçš„è§£å†³æ–¹æ¡ˆ](./Condaä¸åœ¨PATHçš„è§£å†³æ–¹æ¡ˆ.md)

---

## ç¬¬äºŒæ­¥ï¼šè·å–é¡¹ç›®ä»£ç 

### 2.1 å…‹éš†é¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°
git clone https://github.com/yourusername/CodeRetrievr.git

# è¿›å…¥é¡¹ç›®ç›®å½•
cd CodeRetrievr
```

### 2.2 æ£€æŸ¥é¡¹ç›®ç»“æ„

ç¡®ä¿é¡¹ç›®ç›®å½•åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š
```
CodeRetrievr/
â”œâ”€â”€ app/                    # åç«¯åº”ç”¨ä»£ç 
â”œâ”€â”€ data/                   # æ•°æ®å­˜å‚¨ç›®å½•
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”œâ”€â”€ scripts/                # è„šæœ¬å·¥å…·
â”œâ”€â”€ docker-compose.yml      # Dockerç¼–æ’æ–‡ä»¶
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ env                     # ç¯å¢ƒå˜é‡æ¨¡æ¿
â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜
```

---

## ç¬¬ä¸‰æ­¥ï¼šé…ç½®Pythonç¯å¢ƒ

> ğŸ’¡ **é‡è¦**ï¼šæœ¬é¡¹ç›®**å¼ºçƒˆæ¨èä½¿ç”¨ Anaconda**ï¼Œå› ä¸ºå®ƒå¯ä»¥æ›´å¥½åœ°ç®¡ç†ç§‘å­¦è®¡ç®—åŒ…ï¼ˆå¦‚ PyTorchï¼‰ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰å®‰è£… Anacondaï¼Œè¯·å…ˆå®Œæˆ [ç¬¬ä¸€æ­¥ï¼šå®‰è£… Anaconda](#14-å®‰è£…-anacondaå¼ºçƒˆæ¨è)ã€‚

### 3.1 åˆ›å»º Conda ç¯å¢ƒï¼ˆæ¨èæ–¹å¼ï¼‰

> ğŸ’¡ **é‡è¦**ï¼šå¦‚æœ conda å‘½ä»¤æ— æ³•ä½¿ç”¨ï¼Œè¯·å…ˆæŸ¥çœ‹ [Condaä¸åœ¨PATHçš„è§£å†³æ–¹æ¡ˆ](./Condaä¸åœ¨PATHçš„è§£å†³æ–¹æ¡ˆ.md)

**æ­¥éª¤1ï¼šåˆ›å»º conda ç¯å¢ƒ**

**å¦‚æœ conda åœ¨ PATH ä¸­ï¼š**
```bash
# åˆ›å»ºåä¸º coderetrievr çš„ Python 3.9 ç¯å¢ƒ
conda create -n coderetrievr python=3.9 -y
```

**å¦‚æœ conda ä¸åœ¨ PATH ä¸­ï¼ˆWindowsç”¨æˆ·ï¼‰ï¼š**
1. æ‰“å¼€ **Anaconda Prompt**ï¼ˆä»å¼€å§‹èœå•ï¼‰
2. å¯¼èˆªåˆ°é¡¹ç›®ç›®å½•ï¼š`cd E:\Github\CodeRetrievr`
3. è¿è¡Œï¼š`conda create -n coderetrievr python=3.9 -y`

**å¦‚æœ conda ä¸åœ¨ PATH ä¸­ï¼ˆLinux/macOSç”¨æˆ·ï¼‰ï¼š**
```bash
# åˆå§‹åŒ– condaï¼ˆæ›¿æ¢ ~/anaconda3 ä¸ºæ‚¨çš„å®é™…è·¯å¾„ï¼‰
source ~/anaconda3/etc/profile.d/conda.sh

# åˆ›å»ºç¯å¢ƒ
conda create -n coderetrievr python=3.9 -y
```

**æ­¥éª¤2ï¼šæ¿€æ´»ç¯å¢ƒ**
```bash
# æ¿€æ´»ç¯å¢ƒ
conda activate coderetrievr
```

æ¿€æ´»æˆåŠŸåï¼Œå‘½ä»¤è¡Œæç¤ºç¬¦å‰ä¼šæ˜¾ç¤º `(coderetrievr)`ã€‚

**æ­¥éª¤3ï¼šéªŒè¯ç¯å¢ƒ**
```bash
# æŸ¥çœ‹å½“å‰ç¯å¢ƒ
conda info --envs

# ç¡®è®¤Pythonç‰ˆæœ¬
python --version  # åº”æ˜¾ç¤º Python 3.9.x

# æŸ¥çœ‹å½“å‰ç¯å¢ƒçš„åŒ…
conda list
```

**è¯¦ç»†è¯´æ˜**ï¼š
- [Anacondaç¯å¢ƒé…ç½®æŒ‡å—](./Anacondaç¯å¢ƒé…ç½®æŒ‡å—.md)
- [Condaä¸åœ¨PATHçš„è§£å†³æ–¹æ¡ˆ](./Condaä¸åœ¨PATHçš„è§£å†³æ–¹æ¡ˆ.md)

### 3.2 ä½¿ç”¨ venvï¼ˆå¤‡é€‰æ–¹å¼ï¼Œä¸æ¨èï¼‰

å¦‚æœæ‚¨ä¸æƒ³ä½¿ç”¨ Anacondaï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ venvï¼Œä½†å¯èƒ½åœ¨æŸäº›åŒ…çš„å®‰è£…ä¸Šé‡åˆ°é—®é¢˜ï¼š

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

### 3.3 å®‰è£… Python ä¾èµ–

#### æ–¹æ³•1ï¼šä½¿ç”¨ pip å®‰è£…ï¼ˆæ¨èï¼Œç®€å•ï¼‰

```bash
# ç¡®ä¿å·²æ¿€æ´» conda ç¯å¢ƒ
conda activate coderetrievr

# å‡çº§ pip
python -m pip install --upgrade pip

# å®‰è£…é¡¹ç›®ä¾èµ–
pip install -r requirements.txt
```

#### æ–¹æ³•2ï¼šä½¿ç”¨ conda å®‰è£… PyTorchï¼ˆæ¨èï¼Œæ›´ç¨³å®šï¼‰

å¦‚æœä½¿ç”¨ pip å®‰è£… PyTorch å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨ condaï¼š

```bash
# ç¡®ä¿å·²æ¿€æ´» conda ç¯å¢ƒ
conda activate coderetrievr

# ä½¿ç”¨ conda å®‰è£… PyTorchï¼ˆCPUç‰ˆæœ¬ï¼‰
conda install pytorch cpuonly -c pytorch -y

# å®‰è£…å…¶ä»–ä¾èµ–
pip install -r requirements.txt
```

#### æ–¹æ³•3ï¼šä½¿ç”¨å›½å†…é•œåƒæºï¼ˆå¦‚æœç½‘ç»œè¾ƒæ…¢ï¼‰

```bash
# é…ç½® conda é•œåƒï¼ˆæ¸…åå¤§å­¦æºï¼‰
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
conda config --set show_channel_urls yes

# é…ç½® pip é•œåƒ
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

#### æ–¹æ³•4ï¼šGPU ç‰ˆæœ¬ï¼ˆå¦‚æœæœ‰ NVIDIA GPUï¼‰

```bash
# ç¡®ä¿å·²æ¿€æ´» conda ç¯å¢ƒ
conda activate coderetrievr

# ä½¿ç”¨ conda å®‰è£… PyTorchï¼ˆCUDA 11.8ï¼‰
conda install pytorch pytorch-cuda=11.8 -c pytorch -c nvidia -y

# æˆ–ä½¿ç”¨ pip å®‰è£…ï¼ˆCUDA 11.8ï¼‰
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118

# å®‰è£…å…¶ä»–ä¾èµ–
pip install -r requirements.txt
```

**æ³¨æ„**ï¼š
- å¦‚æœæŸäº›åŒ…å®‰è£…å¤±è´¥ï¼ˆç‰¹åˆ«æ˜¯ torchï¼‰ï¼Œä¼˜å…ˆå°è¯•ä½¿ç”¨ conda å®‰è£…
- ä½¿ç”¨å›½å†…é•œåƒæºå¯ä»¥æ˜¾è‘—æé«˜ä¸‹è½½é€Ÿåº¦
- è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [Anacondaç¯å¢ƒé…ç½®æŒ‡å—](./Anacondaç¯å¢ƒé…ç½®æŒ‡å—.md)

### 3.4 éªŒè¯å®‰è£…

```bash
# ç¡®ä¿å·²æ¿€æ´» conda ç¯å¢ƒ
conda activate coderetrievr

# æ£€æŸ¥Pythonç‰ˆæœ¬
python --version  # åº”æ˜¾ç¤º Python 3.9+

# æ£€æŸ¥ conda ç¯å¢ƒ
conda info --envs  # åº”æ˜¾ç¤º coderetrievr ç¯å¢ƒ

# æ£€æŸ¥å…³é”®åŒ…
python -c "import fastapi; print('FastAPI:', fastapi.__version__)"
python -c "import torch; print('PyTorch:', torch.__version__)"
python -c "import pymilvus; print('PyMilvus:', pymilvus.__version__)"
```

**å¦‚æœé‡åˆ°é—®é¢˜**ï¼Œè¯·å‚è€ƒ [Anacondaç¯å¢ƒé…ç½®æŒ‡å—](./Anacondaç¯å¢ƒé…ç½®æŒ‡å—.md) ä¸­çš„å¸¸è§é—®é¢˜è§£å†³éƒ¨åˆ†ã€‚

---

## ç¬¬å››æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

> ğŸ’¡ **é‡è¦**ï¼šåœ¨è¿›è¡Œæ­¤æ­¥éª¤ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²æ¿€æ´» conda ç¯å¢ƒï¼š`conda activate coderetrievr`

### 4.1 åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶

é¡¹ç›®æ ¹ç›®å½•ä¸‹æœ‰ä¸€ä¸ª `env` æ–‡ä»¶ä½œä¸ºæ¨¡æ¿ã€‚æ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ª `.env` æ–‡ä»¶ï¼š

```bash
# Windows
copy env .env

# macOS/Linux
cp env .env
```

### 4.2 ç¼–è¾‘ .env æ–‡ä»¶

ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ `.env` æ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹**å¿…éœ€**é¡¹ï¼š

#### 4.2.1 Neo4j å¯†ç é…ç½®

```env
NEO4J_PASSWORD=your_actual_password_123
```

**é‡è¦**ï¼šæ­¤å¯†ç å¿…é¡»ä¸ `docker-compose.yml` ç¬¬69è¡Œçš„å¯†ç ä¸€è‡´ï¼š
```yaml
- NEO4J_AUTH=neo4j/your_actual_password_123
```

#### 4.2.2 å¤§æ¨¡å‹APIå¯†é’¥

**DeepSeek APIï¼ˆæ¨èï¼Œå›½å†…å¯ç”¨ï¼‰ï¼š**
1. è®¿é—® [DeepSeekå¹³å°](https://platform.deepseek.com/api_keys)
2. æ³¨å†Œ/ç™»å½•è´¦å·
3. åˆ›å»ºAPIå¯†é’¥
4. é…ç½®åˆ° `.env` æ–‡ä»¶ï¼š
   ```env
   LLM_PROVIDER=deepseek
   LLM_API_KEY=sk-your-deepseek-api-key
   LLM_BASE_URL=https://api.deepseek.com
   LLM_MODEL=deepseek-chat
   ```

**OpenAI APIï¼ˆå¤‡é€‰ï¼‰ï¼š**
1. è®¿é—® [OpenAIå¹³å°](https://platform.openai.com/api-keys)
2. åˆ›å»ºAPIå¯†é’¥
3. é…ç½®åˆ° `.env` æ–‡ä»¶ï¼š
   ```env
   LLM_PROVIDER=openai
   LLM_API_KEY=sk-your-openai-api-key
   LLM_MODEL=gpt-3.5-turbo
   ```

#### 4.2.3 GitHub Token

1. è®¿é—® [GitHub Tokenè®¾ç½®](https://github.com/settings/tokens)
2. ç‚¹å‡» "Generate new token (classic)"
3. è®¾ç½®æƒé™ï¼š
   - `public_repo` (è¯»å–å…¬å¼€ä»“åº“)
   - `read:org` (å¦‚æœéœ€è¦è®¿é—®ç»„ç»‡ä»“åº“)
4. ç”Ÿæˆå¹¶å¤åˆ¶token
5. é…ç½®åˆ° `.env` æ–‡ä»¶ï¼š
   ```env
   GITHUB_TOKEN=ghp_your_github_token
   ```

### 4.3 éªŒè¯ç¯å¢ƒå˜é‡

```bash
# è¿è¡Œç¯å¢ƒæ£€æŸ¥è„šæœ¬
python scripts/check_environment.py
```

---

## ç¬¬äº”æ­¥ï¼šå¯åŠ¨æ•°æ®åº“æœåŠ¡

### 5.1 å¯åŠ¨ Docker æœåŠ¡

ç¡®ä¿ Docker Desktop æ­£åœ¨è¿è¡Œï¼Œç„¶åæ‰§è¡Œï¼š

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆMilvus, Neo4j, etcd, MinIOï¼‰
docker-compose up -d
```

### 5.2 ç­‰å¾…æœåŠ¡å¯åŠ¨

æœåŠ¡å¯åŠ¨éœ€è¦ä¸€äº›æ—¶é—´ï¼ˆçº¦1-2åˆ†é’Ÿï¼‰ã€‚ç­‰å¾…æ‰€æœ‰æœåŠ¡å˜ä¸ºå¥åº·çŠ¶æ€ï¼š

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# åº”è¯¥çœ‹åˆ°æ‰€æœ‰æœåŠ¡çŠ¶æ€ä¸º "healthy" æˆ– "Up"
```

### 5.3 éªŒè¯æœåŠ¡

**éªŒè¯ Milvus:**
```bash
# æ£€æŸ¥å¥åº·çŠ¶æ€
curl http://localhost:9091/healthz

# æˆ–è®¿é—® http://localhost:9091/healthz åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹
```

**éªŒè¯ Neo4j:**
1. è®¿é—® Neo4j æµè§ˆå™¨ï¼šhttp://localhost:7474
2. ä½¿ç”¨ä»¥ä¸‹å‡­æ®ç™»å½•ï¼š
   - ç”¨æˆ·å: `neo4j`
   - å¯†ç : `your_actual_password_123`ï¼ˆæ‚¨åœ¨ .env ä¸­è®¾ç½®çš„å¯†ç ï¼‰
3. æˆ–åœ¨å‘½ä»¤è¡Œæµ‹è¯•ï¼š
   ```bash
   docker exec code-retrievr-neo4j cypher-shell -u neo4j -p your_actual_password_123 "RETURN 1"
   ```

### 5.4 æ£€æŸ¥æœåŠ¡æ—¥å¿—ï¼ˆå¦‚éœ€è¦ï¼‰

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs milvus
docker-compose logs neo4j
```

---

## ç¬¬å…­æ­¥ï¼šéªŒè¯ç¯å¢ƒ

### 6.1 è¿è¡Œç¯å¢ƒæ£€æŸ¥è„šæœ¬

```bash
# æ¿€æ´»Pythonç¯å¢ƒï¼ˆå¦‚æœè¿˜æ²¡æ¿€æ´»ï¼‰
conda activate coderetrievr  # æˆ– source venv/bin/activate

# è¿è¡Œæ£€æŸ¥è„šæœ¬
python scripts/check_environment.py
```

### 6.2 æ£€æŸ¥å„é¡¹æœåŠ¡

è„šæœ¬ä¼šæ£€æŸ¥ï¼š
- âœ… Pythonç‰ˆæœ¬
- âœ… Pythonä¾èµ–åŒ…
- âœ… ç¯å¢ƒå˜é‡é…ç½®
- âœ… DockeræœåŠ¡çŠ¶æ€
- âœ… Milvusè¿æ¥
- âœ… Neo4jè¿æ¥

å¦‚æœæ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼Œæ‚¨å°†çœ‹åˆ°ï¼š
```
âœ… ç¯å¢ƒé…ç½®æ£€æŸ¥é€šè¿‡ï¼
```

---

## ç¬¬ä¸ƒæ­¥ï¼šè¿è¡Œé¡¹ç›®

### 7.1 å¯åŠ¨åç«¯æœåŠ¡

```bash
# ç¡®ä¿å·²æ¿€æ´»Pythonç¯å¢ƒ
conda activate coderetrievr  # æˆ– source venv/bin/activate

# å¯åŠ¨FastAPIæœåŠ¡
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

æœåŠ¡å¯åŠ¨åï¼Œæ‚¨å¯ä»¥è®¿é—®ï¼š
- APIæ–‡æ¡£ï¼šhttp://localhost:8000/docs
- å¥åº·æ£€æŸ¥ï¼šhttp://localhost:8000/health

### 7.2 æµ‹è¯•ä»£ç é‡‡é›†ï¼ˆå¯é€‰ï¼‰

```bash
# é‡‡é›†å•ä¸ªä»“åº“çš„ä»£ç 
python scripts/collect_code.py tiangolo/fastapi --language python

# æŸ¥çœ‹é‡‡é›†ç»“æœ
ls data/code_snippets/
```

### 7.3 å‘é‡åŒ–ä»£ç ï¼ˆå¯é€‰ï¼‰

```bash
# å‘é‡åŒ–ä»£ç ç‰‡æ®µå¹¶å­˜å‚¨åˆ°Milvus
python scripts/vectorize_code.py data/code_snippets/your_file.json --batch-size 100
```

---

## å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1ï¼šDockeræœåŠ¡å¯åŠ¨å¤±è´¥

**ç—‡çŠ¶**ï¼š`docker-compose up -d` å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®ä¿ Docker Desktop æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š
   ```bash
   # Windows
   netstat -ano | findstr :19530
   netstat -ano | findstr :7687
   
   # macOS/Linux
   lsof -i :19530
   lsof -i :7687
   ```
3. å¦‚æœç«¯å£è¢«å ç”¨ï¼Œä¿®æ”¹ `docker-compose.yml` ä¸­çš„ç«¯å£æ˜ å°„
4. æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼š
   ```bash
   docker-compose logs
   ```

### é—®é¢˜2ï¼šNeo4jè¿æ¥å¤±è´¥

**ç—‡çŠ¶**ï¼š`Couldn't connect to localhost:7687`

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ Neo4j å®¹å™¨æ˜¯å¦è¿è¡Œï¼š
   ```bash
   docker-compose ps neo4j
   ```
2. å¦‚æœå®¹å™¨æœªè¿è¡Œï¼Œå¯åŠ¨å®ƒï¼š
   ```bash
   docker-compose up -d neo4j
   ```
3. ç­‰å¾…å®¹å™¨å®Œå…¨å¯åŠ¨ï¼ˆçº¦30ç§’ï¼‰ï¼š
   ```bash
   docker-compose ps neo4j  # ç­‰å¾…çŠ¶æ€å˜ä¸º "healthy"
   ```
4. éªŒè¯å¯†ç æ˜¯å¦æ­£ç¡®ï¼š
   - ç¡®ä¿ `.env` ä¸­çš„ `NEO4J_PASSWORD` ä¸ `docker-compose.yml` ä¸­çš„ `NEO4J_AUTH` ä¸€è‡´
   - è®¿é—® http://localhost:7474 æµ‹è¯•ç™»å½•

### é—®é¢˜3ï¼šPythonä¾èµ–å®‰è£…å¤±è´¥

**ç—‡çŠ¶**ï¼š`pip install -r requirements.txt` å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. å‡çº§ pipï¼š
   ```bash
   python -m pip install --upgrade pip
   ```
2. ä½¿ç”¨å›½å†…é•œåƒæºï¼š
   ```bash
   pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
   ```
3. å•ç‹¬å®‰è£…å¤±è´¥çš„åŒ…ï¼š
   ```bash
   # ä¾‹å¦‚å®‰è£… PyTorch
   pip install torch --index-url https://download.pytorch.org/whl/cpu
   ```
4. æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®

### é—®é¢˜4ï¼šMilvusè¿æ¥è¶…æ—¶

**ç—‡çŠ¶**ï¼š`Connection timeout` æˆ– `Failed to connect`

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç­‰å¾… Milvus å®Œå…¨å¯åŠ¨ï¼ˆå¯èƒ½éœ€è¦1-2åˆ†é’Ÿï¼‰ï¼š
   ```bash
   docker-compose logs milvus
   ```
2. æ£€æŸ¥å¥åº·çŠ¶æ€ï¼š
   ```bash
   curl http://localhost:9091/healthz
   ```
3. ç¡®ä¿æ‰€æœ‰ä¾èµ–æœåŠ¡æ­£å¸¸è¿è¡Œï¼š
   ```bash
   docker-compose ps  # æ£€æŸ¥ etcd å’Œ minio æ˜¯å¦æ­£å¸¸
   ```

### é—®é¢˜5ï¼šç¯å¢ƒå˜é‡æœªåŠ è½½

**ç—‡çŠ¶**ï¼š`ç¯å¢ƒå˜é‡æœªé…ç½®` é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®ä¿ `.env` æ–‡ä»¶å­˜åœ¨äºé¡¹ç›®æ ¹ç›®å½•
2. æ£€æŸ¥ `.env` æ–‡ä»¶æ ¼å¼ï¼ˆæ¯è¡Œä¸€ä¸ªå˜é‡ï¼Œæ— ç©ºæ ¼ï¼‰
3. éªŒè¯ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®åŠ è½½ï¼š
   ```bash
   python -c "from dotenv import load_dotenv; load_dotenv(); import os; print(os.getenv('NEO4J_PASSWORD'))"
   ```

### é—®é¢˜6ï¼šç«¯å£è¢«å ç”¨

**ç—‡çŠ¶**ï¼š`Address already in use` æˆ– `ç«¯å£å·²è¢«å ç”¨`

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹ï¼š
   ```bash
   # Windows
   netstat -ano | findstr :8000
   
   # macOS/Linux
   lsof -i :8000
   ```
2. ç»ˆæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹ï¼Œæˆ–ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£
3. å¯¹äº Docker æœåŠ¡ï¼Œä¿®æ”¹ `docker-compose.yml` ä¸­çš„ç«¯å£æ˜ å°„

---

## å¿«é€Ÿæ£€æŸ¥æ¸…å•

éƒ¨ç½²å®Œæˆåï¼Œè¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š

- [ ] Python 3.9+ å·²å®‰è£…
- [ ] Docker Desktop å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] é¡¹ç›®ä»£ç å·²å…‹éš†
- [ ] Python è™šæ‹Ÿç¯å¢ƒå·²åˆ›å»ºå¹¶æ¿€æ´»
- [ ] Python ä¾èµ–å·²å®‰è£…
- [ ] `.env` æ–‡ä»¶å·²åˆ›å»ºå¹¶é…ç½®
- [ ] Docker æœåŠ¡å·²å¯åŠ¨ï¼ˆMilvus, Neo4j, etcd, MinIOï¼‰
- [ ] æ‰€æœ‰æœåŠ¡çŠ¶æ€ä¸º "healthy"
- [ ] ç¯å¢ƒæ£€æŸ¥è„šæœ¬é€šè¿‡
- [ ] åç«¯æœåŠ¡å¯ä»¥å¯åŠ¨

---

## ä¸‹ä¸€æ­¥

ç¯å¢ƒé…ç½®å®Œæˆåï¼Œæ‚¨å¯ä»¥ï¼š

1. ğŸ“– é˜…è¯» [é¡¹ç›®åŠŸèƒ½è¯´æ˜.md](./é¡¹ç›®åŠŸèƒ½è¯´æ˜.md) äº†è§£é¡¹ç›®åŠŸèƒ½
2. ğŸ” é˜…è¯» [åŠŸèƒ½å®ç°å®Œæˆæ€»ç»“.md](./åŠŸèƒ½å®ç°å®Œæˆæ€»ç»“.md) äº†è§£å·²å®ŒæˆåŠŸèƒ½
3. ğŸ”„ å‚è€ƒ [ç¯å¢ƒé…ç½®æŒ‡å—.md](./ç¯å¢ƒé…ç½®æŒ‡å—.md) è¿›è¡Œç¯å¢ƒé…ç½®
4. ğŸš€ å¼€å§‹ä½¿ç”¨ API è¿›è¡Œä»£ç æ£€ç´¢

---

## è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ [å¸¸è§é—®é¢˜æ’æŸ¥](#å¸¸è§é—®é¢˜æ’æŸ¥) éƒ¨åˆ†
2. æŸ¥çœ‹ `docs/` ç›®å½•ä¸‹çš„å…¶ä»–æ–‡æ¡£
3. æ£€æŸ¥æœåŠ¡æ—¥å¿—ï¼š`docker-compose logs`
4. è¿è¡Œç¯å¢ƒæ£€æŸ¥ï¼š`python scripts/check_environment.py`

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**åˆ›å»ºæ—¥æœŸ**ï¼š2024å¹´11æœˆ  
**æœ€åæ›´æ–°**ï¼š2024å¹´11æœˆ

